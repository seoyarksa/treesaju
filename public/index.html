<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />

<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet" />


<title>트리 만세력</title>
  <!-- Supabase SDK -->
  <!-- (바꾼 후) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

  
 <!-- 2) Supabase 초기화 (전역 등록) -->
<script>
  // SDK 로드 후 전역에 supabase 가 존재해야 함
  if (!window.supabase) {
    alert("Supabase SDK 로드 실패. 네트워크 또는 CDN 경로를 확인하세요.");
  }
  window.supabaseClient = window.supabase.createClient(
    "https://dxrgobsgeeshkybkbnxo.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4cmdvYnNnZWVzaGt5YmtibnhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwOTAyNzIsImV4cCI6MjA3MzY2NjI3Mn0.vD1xSRezaTC2OUikZZJM7UntQaQWvOxRkvYiMl78UZA"
  );
  // 호환용
  window.client = window.supabaseClient;
  console.log("[INDEX] supabaseClient ready:", !!window.supabaseClient);
</script>

<style>
  body {
    font-family: 'Nanum Gothic', sans-serif;
    margin: 0; padding: 0;
    background-color: #f8f8f8;
  }

  /* 덩굴 테두리 컨테이너 전체 감싸기 */
.vine-border-container {
  position: relative;
  display: inline-block;   /* ✅ 내용 크기만큼만 박스 크기 */
  padding: 40px;
  max-width: 100%;       /* ✅ 화면 전체 폭까지 가능 */
  width: auto;           /* ✅ 내용 크기에 맞게 기본은 auto */
  margin: 40px auto 80px auto;
  background-color: transparent;
  border: none;
  border-radius: 0;
  overflow: visible;     /* 넝쿨 이미지가 영역 밖에 있을 수 있게 */
}

  /* 흐릿한 배경 (내용 전체 배경 역할) */
  .text-bg {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: rgba(255, 255, 255, 0.7);
    border-radius: 10px;
    z-index: 1;
    pointer-events: none;
  }

/* 덩굴 이미지 4모서리 */
.vine-deco {
  position: absolute;
  width: 150px; 
  height: 150px;
  background-image: url('/images/vine.png');
  background-size: contain;
  background-repeat: no-repeat;
  opacity: 1;
  pointer-events: none;   /* 입력 가리지 않음 */
  z-index: 9999;          /* ✅ 덩굴을 항상 맨 위로 */
}

.vine-top-left {
  top: 0; left: 0;
  transform: rotate(180deg);
}
.vine-top-right {
  top: 0; right: 0;
  transform: scaleX(-1) rotate(180deg);
}
.vine-bottom-left {
  bottom: 0; left: 0;
  transform: scaleY(-1) rotate(180deg);
}
.vine-bottom-right {
  bottom: 0; right: 0;
  transform: scaleX(-1) scaleY(-1) rotate(180deg);
}

/* 내부 콘텐츠 영역 - 덩굴보다 뒤에 위치 */
.vine-border-container > *:not(.text-bg):not(.vine-deco) {
  position: relative;
  z-index: 1;   /* ✅ 덩굴보다 낮게 */
}

  /* 제목, 폼 스타일 */
  h1 {
    margin-top: 0;
    color: #222;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.25);
  }

  form#saju-form {
    margin-top: 20px;
  }

  /* 결과 및 질문 박스 스타일 */
  #result,
  #sewoon,
  #today-saju-container,
  #question-box {
    background-color: rgba(255, 255, 255, 0.9);
    padding: 15px;
    margin-top: 20px;
    border-radius: 8px;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
    color: #222;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
  }

  /* 테이블 스타일 (결과 내부 테이블용) */
  #result table,
  #sewoon table,
  #today-saju-container table {
    width: 100%;
    border-collapse: collapse;
  }
  #result table th,
  #result table td,
  #sewoon table th,
  #sewoon table td,
  #today-saju-container table th,
  #today-saju-container table td {
    padding: 8px 12px;
    border: 1px solid #ccc;
    background-color: transparent;
    color: #222;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  }
.btn-success {
  background-color: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
}

.btn-success:hover {
  background-color: #218838;
}
.sewoon-cell.selected {
  background-color: #dff0d8; /* 연한 연두색 */
  border: 2px solid #28a745;
  box-shadow: 0 0 4px rgba(40,167,69,0.5);
}

  .green { color: green; font-weight: bold; }
  .red { color: red; font-weight: bold; }

    #sinsal-box table td {
      text-align: center;
      vertical-align: middle;
    }

#sinsal-box table {
  margin-left: auto;
  margin-right: auto;
}

#basic-section, #sinsal-section {
  display: none;
}



.tooltip {
  position: relative;
  cursor: pointer;
}

.tooltip::after {
  content: attr(data-desc);
  position: absolute;
  background: #333;
  color: #fff;
  padding: 6px 10px;
  border-radius: 4px;
  font-size: 13px;
  z-index: 9999;

  /* 여러 줄 출력 가능 */
  white-space: normal;
  word-break: keep-all;   /* 단어 단위 줄바꿈 (띄어쓰기 기준) */
  max-width: 600px;       /* 줄바꿈 발생할 최대 폭 */
  line-height: 1.5;
  text-align: left;

  /* 위치: 요소 위쪽 중앙 */
  bottom: 120%;
  left: 50%;
  transform: translateX(-50%);

  display: block;         /* ✅ 세로 한줄 문제 방지 */
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
}

.tooltip:hover::after {
  opacity: 1;
}

.nackhwa-table {
  border-collapse: collapse !important;   /* ✅ 상위 테이블 속성 무시 */
  width: 100%;
}

.nackhwa-table td,
.nackhwa-table th {
  border: 1px solid #999 !important;      /* ✅ 내부 칸 선 강제 표시 */
  padding: 2px;
}

      .parent #nackhwaPopup .nackhwa-table td,
.parent #nackhwaPopup .nackhwa-table th {
  border: 1px solid #999 !important;
}

#nackhwaPopup {
  width: auto !important;      /* ✅ 자동 크기 */
  min-width: unset !important; /* ✅ 기본 제한 해제 */
  max-width: none !important;  /* ✅ 최대폭 제한 해제 */
  height: auto !important;     /* ✅ 높이도 자동 */
  white-space: nowrap;         /* ✅ 줄바꿈 방지 */
}

.btn-success.active {
  background-color: #f18997; 
  color: #fff;
}

/* 고객 이력 표 전체 */
#saju-history-table {
  width: 100%;
  border-collapse: collapse; /* 이중선 제거 */
  font-size: 14px;
  margin-top: 10px;
}

/* 셀 공통 스타일 */
#saju-history-table th,
#saju-history-table td {
  border: 1px solid #e0e0e0;
  padding: 8px 12px;
  text-align: center;
}

/* 헤더 줄 */
#saju-history-table th {
  background-color: #f8f9fa;
  font-weight: bold;
}

/* 줄무늬 효과 */
#saju-history-table tr:nth-child(even) {
  background-color: #fcfcfc;
}

/* hover 효과 */
#saju-history-table tr:hover {
  background-color: #f1f7ff;
}

/* 이름 클릭 링크 */
.saju-record-link {
  cursor: pointer;
  color: #007bff;
  text-decoration: underline;
}

/* 삭제 버튼 */
.delete-record-btn {
  background: #ff4d4f;
  border: none;
  color: white;
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 4px;
  cursor: pointer;
}
.delete-record-btn:hover {
  background: #d9363e;
}




#page-info {
  margin-top: 12px;
  text-align: center;   /* ✅ 전체 가운데 정렬 */
}

.page-btn,
.page-num {
  margin: 0 2px;          /* ✅ 간격 줄임 */
  padding: 2px 4px;       /* ✅ 안쪽 여백도 줄임 */
  border: none;
  background: none;
  cursor: pointer;
  font-size: 14px;
  color: #000;            /* 기본 검정색 */
}

.page-btn:hover,
.page-num:hover {
  text-decoration: underline;
}

.page-num.active {
  font-weight: bold;
  color: red;             /* ✅ 현재 페이지만 빨강 */
  text-decoration: none;
}





</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">



<!-- 2. flatpickr JS (★ 먼저 불러와야 함) -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


</head>
<body>

<!-- 덩굴 테두리 컨테이너가 페이지 내용 전체 감싸기 -->
<div class="vine-border-container">
  <div class="text-bg"></div>

  <div class="vine-deco vine-top-left"></div>
  <div class="vine-deco vine-top-right"></div>
  <div class="vine-deco vine-bottom-left"></div>
  <div class="vine-deco vine-bottom-right"></div>

  <h1>트리 만세력</h1>
<!-- 로그인/로그아웃 영역 -->
<div id="auth-section" class="auth-section" style="margin-top:20px;">
  <form id="login-form">
    <table class="auth-table">
      <tr>
        <!-- 이메일 입력 -->
        <td>
          <input type="email" id="email" placeholder="이메일" style="padding:5px; width:120px;">
        </td>
        <!-- 로그인 / 회원가입 -->
        <td>
            <input type="password" id="password" placeholder="비밀번호" style="padding:5px; width:60px;">
          <button type="button" id="loginBtn" class="btn-success">로그인</button>
          <button type="button" id="signupBtn" class="btn-success" style="margin-left:8px; background-color:#fab7b7; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">회원가입</button>
        </td>
      </tr>
      <tr>
        <!-- 비밀번호 입력 -->
<td style="text-align: right; color: blue;">
  간편로그인:
</td>


  <td>
  <div class="social-login">
    <!-- 구글 로그인 버튼 -->
    <img src="images/구글로그인.png" 
         alt="Google 로그인" 
         class="login-btn" 
         id="googleLogin" />

    <!-- 카카오 로그인 버튼 -->
    <img src="images/카카오로그인.png" 
         alt="Kakao 로그인" 
         class="login-btn" 
         id="kakaoLogin" />
  </div>
</td>

      </tr>
    </table>
  </form>
</div>

<!-- 로그인 후 표시 -->
<div id="profile-section" style="display:none; margin-top:8px;">
  <span id="user-nickname" style="font-weight:600; color: blue;"></span> 님 환영합니다
 
  <button id="logoutBtn" type="button" style="margin-left:8px; background-color:#fab7b7; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">로그아웃</button><br>
  <button id="toggle-history-btn" style="background-color:#4CAF50; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">고객data</button>
  <button id="subscribeBtn" type="button" style="margin-left:8px;background-color:#4CAF50; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">정기구독</button>


<!-- 패널 (처음엔 숨김) -->
<div id="saju-history-panel" style="display:none; margin-top:10px;">
  <!-- 검색 -->
  <div>
    <input type="text" id="search-name" placeholder="이름 검색" style="background-color:#f7f4df; border:1px solid #ccc; padding:5px; border-radius:4px; width:60px;">
    <button id="search-btn" style="background-color:#4CAF50; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">검색</button>
  </div>

  <!-- 테이블 -->
  <table border="1" width="100%" id="saju-history-table">
    <thead>
      <tr>
        <th>이름</th>
        <th>생년월일</th>
        <th>성별</th>
        <th>등록일</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- 페이지 컨트롤 -->
  <div style="margin-top:10px;">
    <button id="prev-page">이전</button>
    <span id="page-info">페이지 1</span>
    <button id="next-page">다음</button>
  </div>
</div>


</div>

<!-- 결제 모달 -->
<div id="subscriptionModal" style="display:none; margin-top:20px; border:1px solid #ccc; padding:16px;">
  <h3>정기구독 결제</h3>
  <p>전화번호 인증이 완료되었습니다. 결제 방법을 선택하세요.</p>
  <button onclick="startGoogleSubscription()">Google 정기구독 결제</button>
  <button onclick="startKakaoSubscription()">Kakao 정기구독 결제</button>
</div>




    <form id="saju-form">
      <label>고객명:</label>
<input type="text" id="customer-name" placeholder="저장관리용" style="background-color:#f7f4df; border:1px solid #ccc; padding:5px; border-radius:4px; width:60px;" />
 <label for="gender">성별:</label>
<select id="gender">
  <option value="">선택</option>
  <option value="male" >남자</option>
  <option value="female">여자</option>
</select>
<br />

    <label>생년월일:</label> 
    <input  type="text" id="birth-date" placeholder="YYYYMMDD" class="birthdate-input" style="background-color:#f7dff5; border:1px solid #ccc; padding:5px; border-radius:4px; width:80px;"/>

    
    <select id="calendar-type" name="calendar-type">
      <option value="선택" ></option>
                                    <option value="solar" >양력</option>
      <option value="lunar">음력</option>
    </select>

<br />

    <label>출생 시간:</label>
                         <label><input type="radio" name="ampm" value="AM" > 오전</label>
    <label><input type="radio" name="ampm" value="PM"> 오후</label>
    <label>+</label>
    <select id="hour-select">
      <option value="선택"></option>
       <option value="0">0시</option>
      <option value="1">1시</option>
      <option value="2">2시</option>
                                    <option value="3" >3시</option>
      <option value="4">4시</option>
      <option value="5">5시</option>
      <option value="6">6시</option>
      <option value="7">7시</option>
      <option value="8" >8시</option>
      <option value="9">9시</option>
      <option value="10">10시</option>
      <option value="11">11시</option>
    </select>
<select id="minute-select">
  <option value="선택"></option>
  <option value="0">0분</option>
  <option value="1">1분</option>
  <option value="2">2분</option>
  <option value="3">3분</option>
  <option value="4">4분</option>
  <option value="5">5분</option>
  <option value="6">6분</option>
  <option value="7">7분</option>
  <option value="8">8분</option>
  <option value="9">9분</option>
                             <option value="10" >10분</option>
  <option value="11">11분</option>
  <option value="12">12분</option>
  <option value="13">13분</option>
  <option value="14">14분</option>
  <option value="15">15분</option>
  <option value="16">16분</option>
  <option value="17">17분</option>
  <option value="18">18분</option>
  <option value="19">19분</option>
  <option value="20">20분</option>
  <option value="21">21분</option>
  <option value="22">22분</option>
  <option value="23">23분</option>
  <option value="24">24분</option>
  <option value="25">25분</option>
  <option value="26">26분</option>
  <option value="27">27분</option>
  <option value="28">28분</option>
  <option value="29">29분</option>
  <option value="30">30분</option>
  <option value="31">31분</option>
  <option value="32">32분</option>
  <option value="33">33분</option>
  <option value="34">34분</option>
  <option value="35">35분</option>
  <option value="36">36분</option>
  <option value="37">37분</option>
  <option value="38">38분</option>
  <option value="39">39분</option>
  <option value="40">40분</option>
  <option value="41">41분</option>
  <option value="42">42분</option>
  <option value="43">43분</option>
  <option value="44">44분</option>
  <option value="45">45분</option>
  <option value="46">46분</option>
  <option value="47">47분</option>
  <option value="48">48분</option>
  <option value="49">49분</option>
  <option value="50">50분</option>
  <option value="51">51분</option>
  <option value="52">52분</option>
  <option value="53">53분</option>
  <option value="54">54분</option>
  <option value="55">55분</option>
  <option value="56">56분</option>
  <option value="57">57분</option>
  <option value="58">58분</option>
  <option value="59">59분</option>
</select><br />

  <!-- 기존 버튼 -->
  <button type="button" id="sajuSubmit" class="btn-success">사주식 출력</button>
  <button type="button" id="sinsalBtn" class="btn-success">신살보기</button>
<span id="count-display"></span>
 
  </form>




<div class="note-box">
  ※ 태어난 분대가 20~40분(30분 근처)에 있는 분은 정확한 시주가 <br>산출되지 않을 수도 있으니 따로 확인해 주세요! <br>한국썸머타임은 적용된 상태입니다. 
</div>
<div id="result" style="display:none;">

<!-- 공통 (항상 표시) -->
<div id="common-section">
  <div id="birth-info"></div>
  <div id="ganji-table"></div>
  <div id="today-saju-container" style="margin-top:30px;"></div>
</div>

<!-- 기본 모드 -->
<div id="basic-section" style="display:none;">
  <div id="dangryeong-table" class="dangryeong-table"></div>

  <!-- ✅ basic 전용 대운/세운 -->
  <div id="basic-daeyun-table" class="daeyun-table-container"></div>

</div>

<!-- 신살류 모드 -->
<div id="sinsal-section" style="display:none;">
  <!-- ✅ sinsal 전용 대운/세운 -->
  <div id="sinsal-daeyun-table" class="daeyun-table-container"></div>
  

  <div id="sinsal-box"></div>
  <div id="etc-sinsal-box"></div>
</div>




  <div id="question-box" style="margin-top: 40px; padding: 20px; border-top: 1px solid #ccc;">
    <h3>질문하기</h3>
    <textarea id="question-input" placeholder="궁금한 점을 문의하세요...(반드시 사주출력후 질문하세요)" rows="8" style="width: 100%; padding: 10px;"></textarea>
    <br />
    <button id="send-email-button" style="margin-top: 10px; padding: 10px 20px;">보내기 (이메일)</button>
  </div>
</div>

  <div id="container"></div>  <!-- ✅ 여기에 출력 -->
<!-- EmailJS SDK 추가 -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script type="module" src="app.js"></script>

<script>
  const buttons = document.querySelectorAll("#sajuSubmit, #sinsalBtn");

  buttons.forEach(btn => {
    btn.addEventListener("click", () => {
      // 모든 버튼에서 active 제거
      buttons.forEach(b => b.classList.remove("active"));
      // 클릭된 버튼에 active 추가
      btn.classList.add("active");
    });
  });
</script>


</body>
</html>



